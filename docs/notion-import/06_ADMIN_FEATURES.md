# 管理者機能設計書

**プロジェクト:** S×S Manager
**バージョン:** 1.0.0
**作成日:** 2026-01-09
**最終更新:** 2026-01-09

---

## 📋 目次

1. [概要](#概要)
2. [画面設計](#画面設計)
3. [機能要件](#機能要件)
4. [API設計](#api設計)
5. [データモデル](#データモデル)
6. [実装計画](#実装計画)

---

## 概要

### 目的
管理者がシフトを効率的に管理・分析するための機能群

### 対象ユーザー
- 店舗管理者
- シフト管理者
- 人事担当者

### 主要機能
1. **ダッシュボード** - 全体把握
2. **Excel風シフト表** - 詳細閲覧
3. **分析・統計** - データ分析
4. **シフト承認** - 承認ワークフロー
5. **スタッフ管理** - 従業員情報管理

---

## 画面設計

### 1. 管理者ダッシュボード

**画面構成:**
```
┌─────────────────────────────────────┐
│ 管理者ダッシュボード         [← 戻る] │
├─────────────────────────────────────┤
│ サマリーカード                       │
│ ┌──────┐ ┌──────┐ ┌──────┐       │
│ │📊今月 │ │💰人件費│ │👥スタッフ│       │
│ │ 45日 │ │¥350万│ │  12人│       │
│ └──────┘ └──────┘ └──────┘       │
├─────────────────────────────────────┤
│ クイックアクション                   │
│ ┌──────────────────────┐         │
│ │ 📋 Excel風シフト表を見る│         │
│ └──────────────────────┘         │
│ ┌──────────────────────┐         │
│ │ 📊 分析・統計          │         │
│ └──────────────────────┘         │
│ ┌──────────────────────┐         │
│ │ ✅ 承認待ちシフト (3件)│         │
│ └──────────────────────┘         │
│ ┌──────────────────────┐         │
│ │ 👥 スタッフ管理        │         │
│ └──────────────────────┘         │
└─────────────────────────────────────┘
```

**サマリーカードの内容:**
- 今月の勤務日数合計
- 今月の人件費合計
- 登録スタッフ数
- 承認待ち件数（バッジ表示）

**パス:** `/admin/dashboard`

---

### 2. Excel風シフト表

**画面構成:**
```
┌─────────────────────────────────────┐
│ シフト表                   [← 戻る] │
│                                     │
│ 対象月: [2026年1月 ▼]              │
│ 表示形式: [日別▼] [部署別] [個人別]│
│                                     │
│ ┌────────────────────────────────┐ │
│ │日付  │スタッフ│部署 │開始 │終了│ │
│ ├────────────────────────────────┤ │
│ │1/6月 │田中   │カフェ│09:00│18:00│ │
│ │1/6月 │佐藤   │厨房  │10:00│19:00│ │
│ │1/6月 │鈴木   │カフェ│13:00│22:00│ │
│ │1/7火 │田中   │カフェ│09:00│18:00│ │
│ │...                             │ │
│ └────────────────────────────────┘ │
│                                     │
│ フィルター:                         │
│ [スタッフ: 全員 ▼] [部署: 全て ▼]  │
│                                     │
│ [Excel出力] [PDF出力] [印刷]        │
└─────────────────────────────────────┘
```

**表示モード:**

#### A. 日別表示（デフォルト）
- 日付ごとに全スタッフのシフトを表示
- スタッフ名でソート可能

#### B. 部署別表示
```
┌─────────────────────────────────────┐
│ カフェ                              │
│ ├─ 1/6 (月): 田中, 鈴木, 山田        │
│ ├─ 1/7 (火): 田中, 佐藤             │
│ └─ ...                              │
│                                     │
│ 厨房                                │
│ ├─ 1/6 (月): 佐藤                   │
│ └─ ...                              │
└─────────────────────────────────────┘
```

#### C. 個人別表示
```
┌─────────────────────────────────────┐
│ 田中 太郎                           │
│ ├─ 1/6 (月): カフェ 09:00-18:00     │
│ ├─ 1/7 (火): カフェ 09:00-18:00     │
│ └─ 合計: 16時間                     │
└─────────────────────────────────────┘
```

**パス:** `/admin/shift-table`

---

### 3. 分析・統計画面

**画面構成:**
```
┌─────────────────────────────────────┐
│ 分析・統計                 [← 戻る] │
│                                     │
│ 期間: [2026年1月 ▼]                │
│                                     │
│ ┌─ グラフ ─────────────────────┐  │
│ │ 📊 曜日別の勤務人数              │  │
│ │   月 ████████ 8人               │  │
│ │   火 ██████ 6人                 │  │
│ │   水 ██████████ 10人            │  │
│ │   ...                            │  │
│ └──────────────────────────────┘  │
│                                     │
│ ┌─ 統計データ ─────────────────┐  │
│ │ • 総勤務時間: 480時間            │  │
│ │ • 平均勤務時間/人: 40時間        │  │
│ │ • 最多勤務: 田中 (56時間)        │  │
│ │ • 人件費合計: ¥350,000          │  │
│ └──────────────────────────────┘  │
│                                     │
│ ┌─ ヒートマップ ───────────────┐  │
│ │     9-12 12-15 15-18 18-21      │  │
│ │ 月   🟢   🔴    🟡    🟢       │  │
│ │ 火   🟡   🟢    🟢    🟡       │  │
│ │ ...                              │  │
│ └──────────────────────────────┘  │
└─────────────────────────────────────┘
```

**集計軸:**
- 個人別
- 部署別（ジョブ別）
- 時間帯別
- 日別
- 曜日別
- 週別
- 月別

**パス:** `/admin/analytics`

---

### 4. シフト承認画面

**画面構成:**
```
┌─────────────────────────────────────┐
│ シフト承認                 [← 戻る] │
│                                     │
│ [承認待ち: 3件] [承認済み] [却下]  │
│                                     │
│ ┌─────────────────────────────────┐│
│ │ 田中 太郎                        ││
│ │ 提出日時: 2026-01-05 14:30       ││
│ │ 対象月: 2026年1月                ││
│ │ 勤務日数: 16日 (128時間)         ││
│ │                                  ││
│ │ [詳細を見る] [承認] [却下]       ││
│ └─────────────────────────────────┘│
│                                     │
│ ┌─────────────────────────────────┐│
│ │ 佐藤 花子                        ││
│ │ ...                              ││
│ └─────────────────────────────────┘│
└─────────────────────────────────────┘
```

**承認フロー:**
1. 従業員がシフト提出
2. 管理者に通知
3. 管理者が承認 or 却下
4. 従業員に通知

**パス:** `/admin/approval`

---

## 機能要件

### 1. ダッシュボード機能

**必須機能:**
- [ ] サマリーカード表示
  - [ ] 今月の勤務日数合計
  - [ ] 今月の人件費合計
  - [ ] 登録スタッフ数
  - [ ] 承認待ち件数
- [ ] クイックアクションボタン
- [ ] 最近の活動タイムライン

**任意機能:**
- [ ] グラフウィジェット
- [ ] カレンダーウィジェット
- [ ] アラート表示

---

### 2. Excel風シフト表機能

**必須機能:**
- [ ] 日別・部署別・個人別の表示切替
- [ ] 月選択
- [ ] スタッフフィルター
- [ ] 部署フィルター
- [ ] Excel出力
- [ ] PDF出力

**任意機能:**
- [ ] ソート機能
- [ ] 検索機能
- [ ] 印刷プレビュー
- [ ] メール送信

---

### 3. 分析・統計機能

**必須機能:**
- [ ] 曜日別グラフ
- [ ] 統計データ表示
- [ ] 期間選択
- [ ] CSV出力

**任意機能:**
- [ ] ヒートマップ
- [ ] 時間帯別グラフ
- [ ] 予実比較
- [ ] 前年同月比較

---

### 4. シフト承認機能

**必須機能:**
- [ ] 承認待ちリスト表示
- [ ] 承認/却下処理
- [ ] 詳細表示
- [ ] 通知機能

**任意機能:**
- [ ] 一括承認
- [ ] コメント機能
- [ ] 承認履歴

---

## API設計

### ダッシュボードAPI

```typescript
// サマリー取得
GET /api/admin/dashboard/summary
Response: {
  totalWorkDays: number
  totalLaborCost: number
  staffCount: number
  pendingApprovals: number
}

// 最近の活動
GET /api/admin/dashboard/activities
Response: Activity[]
```

### シフト表API

```typescript
// シフト一覧取得
GET /api/admin/shifts
Query: {
  month: string // "2026-01"
  mode: "daily" | "department" | "personal"
  staffId?: string
  departmentId?: string
}
Response: Shift[]

// Excel出力
GET /api/admin/shifts/export/excel
Query: { month: string }
Response: File (xlsx)

// PDF出力
GET /api/admin/shifts/export/pdf
Query: { month: string }
Response: File (pdf)
```

### 分析API

```typescript
// 統計データ取得
GET /api/admin/analytics/stats
Query: {
  month: string
  groupBy: "day" | "weekday" | "staff" | "department"
}
Response: {
  totalHours: number
  averageHours: number
  laborCost: number
  breakdown: Record<string, number>
}
```

### 承認API

```typescript
// 承認待ちリスト
GET /api/admin/approvals/pending
Response: PendingShift[]

// 承認処理
POST /api/admin/shifts/:id/approve
Body: {
  comment?: string
}

// 却下処理
POST /api/admin/shifts/:id/reject
Body: {
  reason: string
}
```

---

## データモデル

### AdminDashboardSummary
```typescript
interface AdminDashboardSummary {
  totalWorkDays: number
  totalLaborCost: number
  staffCount: number
  pendingApprovals: number
  lastUpdated: string
}
```

### ShiftTableRow
```typescript
interface ShiftTableRow {
  date: string
  staffId: string
  staffName: string
  departmentId: string
  departmentName: string
  startTime: string
  endTime: string
  hours: number
  status: "approved" | "pending" | "rejected"
}
```

### AnalyticsData
```typescript
interface AnalyticsData {
  period: string
  groupBy: string
  totalHours: number
  averageHours: number
  laborCost: number
  breakdown: Record<string, {
    hours: number
    cost: number
    count: number
  }>
}
```

---

## 実装計画

### Phase 1: 基本機能（2週間）

**Week 1:**
- [ ] ダッシュボード画面作成
- [ ] サマリーカード実装
- [ ] ルーティング設定

**Week 2:**
- [ ] Excel風シフト表画面作成
- [ ] 日別表示実装
- [ ] 月選択機能

### Phase 2: 詳細機能（2週間）

**Week 3:**
- [ ] 部署別・個人別表示
- [ ] フィルター機能
- [ ] Excel出力機能

**Week 4:**
- [ ] 分析画面作成
- [ ] グラフ表示
- [ ] 統計データ表示

### Phase 3: 承認機能（1週間）

**Week 5:**
- [ ] 承認待ちリスト表示
- [ ] 承認/却下処理
- [ ] 通知機能

---

## 技術選定

### フロントエンド

**テーブル:**
- **AG Grid Community** (推奨)
  - Excel風の操作感
  - ソート・フィルター標準搭載
  - CSV/Excel出力対応

**グラフ:**
- **Chart.js + vue-chartjs**
  - 棒グラフ、折れ線グラフ
  - シンプルで軽量

**エクスポート:**
- **SheetJS (xlsx)** - Excel出力
- **jsPDF** - PDF出力

---

## セキュリティ要件

### 権限管理
- [ ] 管理者ロールのみアクセス可能
- [ ] JWT認証必須
- [ ] RBAC実装（Role-Based Access Control）

### データ保護
- [ ] 個人情報のマスキング
- [ ] ログ記録（誰が何を見たか）
- [ ] SSL/TLS必須

---

## UI/UXガイドライン

### デザイン原則
1. **シンプル** - 操作回数を最小限に
2. **視覚的** - グラフで直感的に把握
3. **高速** - ページ遷移を最小限に
4. **レスポンシブ** - PC/タブレット対応

### カラー
- プライマリ: 紫グラデーション（既存と統一）
- 承認: 緑
- 却下: 赤
- 保留: 黄色

---

**最終更新:** 2026-01-09
**作成者:** Claude (AI Assistant) + 無才

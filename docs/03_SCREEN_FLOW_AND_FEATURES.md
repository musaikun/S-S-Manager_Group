# 画面遷移図・機能一覧

**プロジェクト:** S×S Manager (Shift Schedule Manager)
**バージョン:** 1.0.0
**作成日:** 2025-01-09
**最終更新:** 2025-01-09

---

## 目次

1. [画面遷移図](#画面遷移図)
2. [画面一覧](#画面一覧)
3. [従業員機能詳細](#従業員機能詳細)
4. [管理者機能詳細](#管理者機能詳細)
5. [共通コンポーネント](#共通コンポーネント)
6. [ナビゲーション仕様](#ナビゲーション仕様)

---

## 画面遷移図

### 従業員モード

```
┌─────────────┐
│   ホーム    │
│ HomeView    │
└──────┬──────┘
       │
       ↓
┌─────────────┐
│ カレンダー  │ ←─────┐
│CalendarView │        │
└──────┬──────┘        │
       │               │
       ↓               │
┌─────────────┐        │
│ 時間登録    │        │
│TimeRegister │        │
│    View     │        │
└──────┬──────┘        │
       │               │
       ↓               │
┌─────────────┐        │
│   確認      │        │
│ ConfirmView │        │
└──────┬──────┘        │
       │               │
       ├───→ 修正 ─────┘
       │
       ↓ 提出
┌─────────────┐
│   履歴      │
│ HistoryView │
└─────────────┘
```

### 管理者モード（将来実装）

```
┌────────────────────┐
│  ダッシュボード    │
│ManagerDashboard    │
└─────────┬──────────┘
          │
          ├─────→ ┌──────────────┐
          │       │  全シフト一覧 │
          │       │  AllShifts    │
          │       └──────────────┘
          │
          ├─────→ ┌──────────────┐
          │       │  承認待ち     │
          │       │PendingApproval│
          │       └──────┬───────┘
          │              │
          │              ├→ 承認/却下
          │              │
          │              ↓
          │       ┌──────────────┐
          │       │  詳細・編集   │
          │       │ ShiftDetail   │
          │       └──────────────┘
          │
          ├─────→ ┌──────────────┐
          │       │  集計        │
          │       │ Aggregation  │
          │       └──────┬───────┘
          │              │
          │              ├→ カレンダー表示
          │              ├→ グラフ表示
          │              └→ CSV出力
          │
          └─────→ ┌──────────────┐
                  │  従業員管理   │
                  │EmployeeManage │
                  └──────────────┘
```

---

## 画面一覧

### 従業員画面（実装済み）

| No | 画面名 | パス | コンポーネント | 説明 |
|----|-------|------|--------------|------|
| 1 | ホーム | `/` | HomeView.vue | アプリの起動画面 |
| 2 | カレンダー | `/calendar` | CalendarView.vue | 日付選択画面 |
| 3 | 時間登録 | `/time-register` | TimeRegisterView.vue | 勤務時間設定画面 |
| 4 | 確認 | `/confirm` | ConfirmView.vue | 提出前確認画面 |
| 5 | 履歴 | `/history` | HistoryView.vue | 提出履歴画面 |

### 管理者画面（将来実装）

| No | 画面名 | パス | コンポーネント | 説明 |
|----|-------|------|--------------|------|
| 6 | ダッシュボード | `/admin/dashboard` | ManagerDashboard.vue | 管理者ホーム |
| 7 | 全シフト一覧 | `/admin/shifts` | AllShifts.vue | 全従業員のシフト |
| 8 | 承認待ち | `/admin/pending` | PendingApproval.vue | 承認待ちシフト |
| 9 | 集計 | `/admin/aggregation` | Aggregation.vue | シフト集計・統計 |
| 10 | 従業員管理 | `/admin/employees` | EmployeeManage.vue | 従業員の追加・編集 |
| 11 | レポート | `/admin/reports` | Reports.vue | レポート出力 |

### 認証画面（将来実装）

| No | 画面名 | パス | コンポーネント | 説明 |
|----|-------|------|--------------|------|
| 12 | ログイン | `/login` | LoginView.vue | ログイン |
| 13 | 新規登録 | `/register` | RegisterView.vue | 新規ユーザー登録 |
| 14 | パスワードリセット | `/password-reset` | PasswordReset.vue | パスワード再設定 |

---

## 従業員機能詳細

### 1. ホーム画面 (HomeView)

**目的:** アプリの起動画面、次のアクションへの導線

**機能:**
- アプリケーション説明
- 新規シフト作成ボタン
- 直近の提出履歴表示（将来実装）
- 通知バッジ表示（将来実装）

**UI要素:**
- タイトル: "S×S Manager"
- サブタイトル: "複数バイト先のシフト管理を簡単に"
- CTA: "シフトを作成する" → カレンダー画面へ
- CTA: "履歴を見る" → 履歴画面へ

**遷移先:**
- カレンダー画面 (`/calendar`)
- 履歴画面 (`/history`)

---

### 2. カレンダー画面 (CalendarView)

**目的:** シフト希望日の選択

**機能:**

#### 2.1 月選択
- ✅ 今月・来月の切り替えボタン
- ✅ 現在選択中の月を強調表示
- ❌ 前月への移動は不可（過去のシフト提出を防ぐ）

#### 2.2 掛け持ちジョブ管理
- ✅ ジョブ追加（最大4件）
- ✅ ジョブ名編集
- ✅ ジョブ削除
- ✅ 固定蛍光色の自動割り当て
  - ジョブ1: 蛍光黄色 (#FFFF00)
  - ジョブ2: 蛍光緑 (#39FF14)
  - ジョブ3: 蛍光ピンク (#FF10F0)
  - ジョブ4: 蛍光水色 (#00FFFF)
- ✅ 本店名のカスタマイズ

#### 2.3 ジョブ選択モード
- ✅ 現在選択中のジョブをバナー表示
- ✅ 「本店で選択しています」 / 「〇〇で選択しています」
- ✅ ジョブ切り替え

#### 2.4 日付選択
- ✅ 個別日付クリック（トグル）
- ✅ 休日基準で一括選択（土日祝日+平日）
- ✅ 平日のみ一括選択
- ✅ 曜日別一括選択（月〜日）
- ✅ 全クリア
- ✅ 過去日付は選択不可（グレーアウト）
- ✅ 祝日の赤色表示

#### 2.5 視覚的フィードバック
- ✅ 選択済み日付: 緑色グラデーション
- ✅ 今日: 青枠
- ✅ 休日: 赤文字
- ✅ 土曜: 青文字
- ✅ 日曜: ピンク文字
- ✅ ジョブドット表示
  - 本店: 白丸（黒枠）
  - 掛け持ち先: 蛍光色ドット

#### 2.6 確認ダイアログ
- ✅ 時間設定済み日付を外す際の確認
- ✅ 一括選択で設定済み日付が含まれる場合の確認

**UI要素:**
```
┌────────────────────────────────┐
│ [本店で選択しています]        │ ← ジョブバナー
├────────────────────────────────┤
│        2025年1月               │
│   [今月]  [来月]               │
├────────────────────────────────┤
│ [掛け持ち設定 ▼]              │
│  ├ 本店: メイン店舗            │
│  ├ ジョブ1: 掛け持ち先A 🟡     │
│  └ [+ ジョブを追加]            │
├────────────────────────────────┤
│[休日基準][平日のみ][クリア]    │
│[日][月][火][水][木][金][土]    │ ← 曜日別選択
├────────────────────────────────┤
│ 日 月 火 水 木 金 土           │
│          1  2  3  4            │
│  5  6  7  8  9 10 11           │
│ 12 13 14 15 16 17 18           │
│ 19 20 21 22 23 24 25           │
│ 26 27 28 29 30 31              │
│                                │
│ ドット凡例:                    │
│ ○ 本店  🟡 ジョブ1            │
├────────────────────────────────┤
│ 選択日数: 15日                 │
└────────────────────────────────┘
```

**遷移先:**
- 時間登録画面 (`/time-register`) - 下スワイプまたはボタン

---

### 3. 時間登録画面 (TimeRegisterView)

**目的:** 選択した日付に勤務時間を設定

**機能:**

#### 3.1 ヘッダー設定（一括設定用）
- ✅ 開始時刻設定
- ✅ 終了時刻設定
- ✅ 勤務時間の自動計算・表示

#### 3.2 一括適用
- ✅ 開始時刻のみ適用
- ✅ 終了時刻のみ適用
- ✅ 両方適用
- ✅ 対象選択: 全て / 未設定のみ
- ✅ 曜日フィルター（複数選択可）
- ✅ 週番号フィルター（第1-6週）

#### 3.3 個別設定
- ✅ 日付カードクリックで時間ピッカー表示
- ✅ 開始時刻・終了時刻の個別設定
- ✅ シフトから外す（削除マーク）
- ✅ 設定方法の視覚的表示
  - デフォルト: 緑色
  - 一括設定: 青色
  - 個別設定: 黄色
  - 過去ベース: 薄赤色

#### 3.4 時間競合検出
- ✅ 同日の異なるジョブ間で時間重複を自動検出
- ✅ 競合情報の表示
  - 日付
  - ジョブ名
  - 時間帯
  - 重複時間
- ✅ 本店を含む全ジョブの競合チェック

#### 3.5 統計表示
- ✅ 総勤務日数
- ✅ 総勤務時間
- ✅ 休憩時間の加味（オプション）
  - 6時間未満: 休憩なし
  - 6-8時間: 45分休憩
  - 8時間以上: 60分休憩
- ✅ ジョブ別の統計

#### 3.6 備考入力
- ✅ 自由記述の備考欄

**UI要素:**
```
┌────────────────────────────────┐
│ ◀ カレンダーに戻る             │
├────────────────────────────────┤
│ 開始: [09:00▼] 終了: [18:00▼] │
│ 勤務時間: 8時間                │
├────────────────────────────────┤
│ 一括適用:                      │
│ [開始のみ][終了のみ][両方]     │
│ 対象: [●全て ○未設定のみ]     │
│ 曜日: [☑月][☑火]...[☐日]     │
│ 週: [☑1][☑2]...[☐6]          │
│        [適用する]              │
├────────────────────────────────┤
│ ┌──────────────────────────┐   │
│ │ 1/15(月) 🟡               │   │
│ │ 09:00 - 18:00 (8h)        │   │
│ │ [個別設定] [×外す]        │   │
│ └──────────────────────────┘   │
│ ┌──────────────────────────┐   │
│ │ 1/16(火) ○               │   │
│ │ 09:00 - 18:00 (8h)        │   │
│ │ [個別設定] [×外す]        │   │
│ └──────────────────────────┘   │
├────────────────────────────────┤
│ ⚠️ 時間競合あり:               │
│ 1/15: 本店(09:00-18:00) と     │
│       ジョブ1(17:00-23:00)     │
│       → 1時間重複              │
├────────────────────────────────┤
│ 統計:                          │
│ 総勤務日数: 15日               │
│ 総勤務時間: 120時間            │
│ (休憩加味: 105時間)            │
│                                │
│ 本店: 10日 80時間              │
│ ジョブ1: 5日 40時間            │
├────────────────────────────────┤
│ 備考:                          │
│ [自由入力欄]                   │
├────────────────────────────────┤
│      [確認画面へ進む]          │
└────────────────────────────────┘
```

**遷移先:**
- カレンダー画面 (`/calendar`) - 上スワイプまたは戻るボタン
- 確認画面 (`/confirm`) - 下スワイプまたはボタン

---

### 4. 確認画面 (ConfirmView)

**目的:** 提出前の最終確認

**機能:**
- ✅ 全シフトの一覧表示
- ✅ ジョブ別にグループ化
- ✅ 日付・時間・勤務時間の表示
- ✅ 統計サマリー
- ✅ 時間競合の警告表示
- ✅ 提出モーダル
  - 提出確認メッセージ
  - キャンセル / 提出ボタン

**UI要素:**
```
┌────────────────────────────────┐
│ ◀ 時間登録に戻る               │
├────────────────────────────────┤
│ シフト確認                     │
├────────────────────────────────┤
│ 【本店】                       │
│ ├ 1/15(月) 09:00-18:00 (8h)   │
│ ├ 1/16(火) 09:00-18:00 (8h)   │
│ └ 小計: 2日 16時間             │
│                                │
│ 【ジョブ1: 掛け持ち先A】🟡     │
│ ├ 1/15(月) 19:00-23:00 (4h)   │
│ └ 小計: 1日 4時間              │
├────────────────────────────────┤
│ ⚠️ 注意:                       │
│ 1/15に時間競合があります       │
├────────────────────────────────┤
│ 合計統計:                      │
│ 総勤務日数: 2日                │
│ 総勤務時間: 20時間             │
├────────────────────────────────┤
│ 備考:                          │
│ 今月は平日のみ希望             │
├────────────────────────────────┤
│        [シフトを提出]          │
└────────────────────────────────┘
```

**提出後の動作:**
- 成功メッセージ表示
- 履歴画面へ自動遷移 または ホーム画面へ

**遷移先:**
- 時間登録画面 (`/time-register`) - 修正
- 履歴画面 (`/history`) - 提出後

---

### 5. 履歴画面 (HistoryView)

**目的:** 過去の提出履歴確認（将来実装）

**機能:**
- ❌ 過去の提出一覧（月別）
- ❌ 承認状態の表示
  - 提出済み（黄色）
  - 承認済み（緑色）
  - 却下（赤色）
- ❌ 却下理由の表示
- ❌ 再提出機能
- ❌ 詳細表示

**UI要素:**
```
┌────────────────────────────────┐
│ 提出履歴                       │
├────────────────────────────────┤
│ [2025年1月]                    │
│ 提出日: 2025-01-09             │
│ 状態: ✅ 承認済み              │
│ 総日数: 15日 総時間: 120h      │
│           [詳細を見る]         │
├────────────────────────────────┤
│ [2024年12月]                   │
│ 提出日: 2024-12-10             │
│ 状態: ❌ 一部却下              │
│ 却下理由: 12/25は人員充足      │
│           [再提出する]         │
└────────────────────────────────┘
```

---

## 管理者機能詳細

### 6. ダッシュボード (ManagerDashboard)

**目的:** 管理者の総合ホーム画面

**機能:**
- 店舗選択（複数店舗管理の場合）
- 今月の統計サマリー
- 承認待ちシフト件数バッジ
- 人員不足の日付警告
- クイックアクション
  - 承認待ちシフトへ
  - 集計画面へ
  - レポート出力へ

**UI要素:**
```
┌────────────────────────────────┐
│ 管理ダッシュボード             │
│ 店舗: [メイン店舗 ▼]          │
├────────────────────────────────┤
│ 今月の状況 (2025年1月)        │
│ ┌──────┐┌──────┐┌──────┐     │
│ │承認待ち││今月の││今月の│     │
│ │  15件 ││従業員││総時間│     │
│ │   🔔 ││ 20人 ││1200h │     │
│ └──────┘└──────┘└──────┘     │
├────────────────────────────────┤
│ ⚠️ 注意が必要な日:             │
│ 1/20(月): 3人 (目標8人)       │
│ 1/25(土): 4人 (目標10人)      │
├────────────────────────────────┤
│ クイックアクション:            │
│ [承認待ちを確認]               │
│ [集計を見る]                   │
│ [レポート出力]                 │
└────────────────────────────────┘
```

---

### 7. 全シフト一覧 (AllShifts)

**目的:** 全従業員のシフトを一覧表示

**機能:**
- カレンダービュー / リストビュー切り替え
- 日付フィルター
- 従業員フィルター
- ステータスフィルター（提出済み/承認済み/却下）
- 日付クリックで詳細表示
- 一括承認機能

**カレンダービュー:**
```
┌────────────────────────────────┐
│        2025年1月               │
│ 日 月 火 水 木 金 土           │
│          1  2  3  4            │
│         3人 5人 7人 8人        │ ← 人数表示
│  5  6  7  8  9 10 11           │
│ 2人 6人 8人 8人 7人 4人 3人    │
│         └赤色 (人手不足)       │
└────────────────────────────────┘
```

**リストビュー:**
```
┌────────────────────────────────┐
│ フィルター:                    │
│ 日付: [2025-01-15 ▼]          │
│ 従業員: [全員 ▼]              │
│ 状態: [全て ▼]                │
├────────────────────────────────┤
│ 1/15(月) - 8人                │
│ ┌──────────────────────────┐   │
│ │ 👤 山田太郎 ✅             │   │
│ │ 09:00-18:00 (8h)          │   │
│ └──────────────────────────┘   │
│ ┌──────────────────────────┐   │
│ │ 👤 佐藤花子 ⏳             │   │
│ │ 10:00-19:00 (8h)          │   │
│ │ [承認] [却下]             │   │
│ └──────────────────────────┘   │
└────────────────────────────────┘
```

---

### 8. 承認待ち (PendingApproval)

**目的:** 承認待ちシフトの処理

**機能:**
- 承認待ちシフト一覧
- 従業員別にグループ化
- シフト詳細表示
- 承認ボタン
- 却下ボタン（理由入力必須）
- 一括承認
- コメント追加

**UI要素:**
```
┌────────────────────────────────┐
│ 承認待ちシフト (15件)         │
├────────────────────────────────┤
│ 【山田太郎】                   │
│ 提出日: 2025-01-09             │
│ 期間: 1/15 - 1/31 (10日)      │
│ 総時間: 80時間                 │
│                                │
│ 詳細:                          │
│ 1/15(月) 09:00-18:00           │
│ 1/16(火) 09:00-18:00           │
│ ...                            │
│                                │
│ 競合: なし                     │
│                                │
│ [全て承認] [個別確認]          │
├────────────────────────────────┤
│ 【佐藤花子】                   │
│ ...                            │
└────────────────────────────────┘
```

**却下ダイアログ:**
```
┌────────────────────────────────┐
│ シフト却下                     │
├────────────────────────────────┤
│ 理由を選択:                    │
│ ○ 人員充足                    │
│ ○ 営業日ではない              │
│ ● その他                      │
│                                │
│ コメント:                      │
│ [その日は既に8人いるため]      │
│                                │
│    [キャンセル] [却下する]     │
└────────────────────────────────┘
```

---

### 9. 集計 (Aggregation)

**目的:** シフトデータの集計・分析

**機能:**

#### 9.1 カレンダー集計ビュー
- 日別人数表示
- 色分け（人手不足/適正/十分）
- 日付クリックで詳細

#### 9.2 統計グラフ
- 日別従業員数の推移（折れ線グラフ）
- 曜日別平均人数（棒グラフ）
- 従業員別勤務時間（円グラフ）

#### 9.3 レポート
- 期間選択（今月/先月/カスタム）
- 総勤務時間
- 従業員別集計
- 最多出勤者ランキング
- CSV/Excel出力

**UI要素:**
```
┌────────────────────────────────┐
│ 集計・統計                     │
│ 期間: [2025年1月 ▼]           │
├────────────────────────────────┤
│ タブ: [カレンダー][グラフ][表]│
├────────────────────────────────┤
│ (カレンダービュー)             │
│ 日 月 火 水 木 金 土           │
│          1  2  3  4            │
│         3  5  7  8             │
│         🔴🟠🟢🟢             │
│                                │
│ 🔴 3人以下 (人手不足)          │
│ 🟠 4-6人 (やや不足)            │
│ 🟢 7人以上 (適正)              │
├────────────────────────────────┤
│ 今月の統計:                    │
│ 総勤務日数: 450日分            │
│ 総勤務時間: 3600時間           │
│ 平均人数/日: 7.2人             │
│                                │
│    [CSVダウンロード]           │
└────────────────────────────────┘
```

---

### 10. 従業員管理 (EmployeeManage)

**目的:** 従業員の登録・編集・削除

**機能:**
- 従業員一覧表示
- 新規従業員追加
- 従業員情報編集
- 従業員削除（過去データは保持）
- 権限設定（従業員/管理者）
- メール招待送信

**UI要素:**
```
┌────────────────────────────────┐
│ 従業員管理                     │
│          [+ 新規追加]          │
├────────────────────────────────┤
│ 検索: [名前で検索...]          │
├────────────────────────────────┤
│ ┌──────────────────────────┐   │
│ │ 👤 山田太郎               │   │
│ │ メール: yamada@...        │   │
│ │ 権限: 従業員              │   │
│ │ 登録日: 2025-01-01        │   │
│ │ [編集] [削除]             │   │
│ └──────────────────────────┘   │
│ ┌──────────────────────────┐   │
│ │ 👤 佐藤花子               │   │
│ │ ...                       │   │
│ └──────────────────────────┘   │
└────────────────────────────────┘
```

**追加/編集ダイアログ:**
```
┌────────────────────────────────┐
│ 従業員追加                     │
├────────────────────────────────┤
│ 名前: [山田太郎]              │
│ メール: [yamada@example.com]   │
│ 権限: [●従業員 ○管理者]       │
│                                │
│ [招待メールを送信する]         │
│                                │
│    [キャンセル] [追加する]     │
└────────────────────────────────┘
```

---

## 共通コンポーネント

### PageSlider

**責務:** スワイプによる画面遷移

**機能:**
- 上下スワイプで前後の画面に遷移
- スワイプチュートリアル表示
- トランジションアニメーション

**使用画面:**
- カレンダー ⇔ 時間登録 ⇔ 確認

---

### ProgressIndicator

**責務:** 進捗状況の表示

**機能:**
- ステップ表示（1. カレンダー → 2. 時間登録 → 3. 確認）
- 現在のステップを強調
- クリックで各ステップに移動

**UI:**
```
┌─────────────────────────────┐
│ ①カレンダー → ●時間登録 → ③確認 │
└─────────────────────────────┘
```

---

### JobManager

**責務:** 掛け持ちジョブの管理UI

**機能:**
- ジョブ一覧表示
- ジョブ追加ボタン
- ジョブ編集・削除
- 本店名編集
- 現在選択中のジョブ切り替え

**UI:**
```
┌────────────────────────────────┐
│ 掛け持ち設定 ▼                 │
├────────────────────────────────┤
│ 本店: メイン店舗 [編集]        │
│                                │
│ ジョブ1 🟡                     │
│ 掛け持ち先A                    │
│ [選択] [編集] [削除]           │
│                                │
│ ジョブ2 🟢                     │
│ 掛け持ち先B                    │
│ [選択] [編集] [削除]           │
│                                │
│ [+ ジョブを追加]               │
└────────────────────────────────┘
```

---

### SettingsModal

**責務:** デフォルト設定の管理

**機能:**
- デフォルト開始時刻設定
- デフォルト終了時刻設定
- ジョブ別デフォルト時刻設定
- LocalStorageへの保存

---

### MainStoreSetupModal

**責務:** 初回起動時の本店名設定

**機能:**
- 本店名入力
- スキップ可能
- LocalStorageへの保存

---

### SwipeTutorial

**責務:** スワイプ操作の説明

**機能:**
- 初回表示時のチュートリアル
- アニメーション表示
- 「次回から表示しない」チェックボックス

---

## ナビゲーション仕様

### ルーティング

```typescript
// frontend/src/router/index.ts
const routes = [
  { path: '/', name: 'home', component: HomeView },
  { path: '/calendar', name: 'calendar', component: CalendarView },
  { path: '/time-register', name: 'time-register', component: TimeRegisterView },
  { path: '/confirm', name: 'confirm', component: ConfirmView },
  { path: '/history', name: 'history', component: HistoryView },

  // 将来実装
  { path: '/login', name: 'login', component: LoginView },
  { path: '/admin/dashboard', name: 'admin-dashboard', component: ManagerDashboard },
  { path: '/admin/shifts', name: 'admin-shifts', component: AllShifts },
  { path: '/admin/pending', name: 'admin-pending', component: PendingApproval },
  { path: '/admin/aggregation', name: 'admin-aggregation', component: Aggregation },
  { path: '/admin/employees', name: 'admin-employees', component: EmployeeManage },
]
```

### 遷移方法

1. **ボタンクリック**
   ```vue
   <button @click="$router.push('/calendar')">
   ```

2. **スワイプ操作**
   - PageSlider コンポーネント経由
   - 上スワイプ: 前の画面
   - 下スワイプ: 次の画面

3. **プログラム的遷移**
   ```typescript
   router.push({ name: 'time-register' })
   ```

### ナビゲーションガード

```typescript
// 認証チェック（将来実装）
router.beforeEach((to, from, next) => {
  if (to.path.startsWith('/admin') && !isManager()) {
    next('/login')
  } else {
    next()
  }
})
```

---

## 将来の拡張機能

### Phase 1: 認証・通知
- ログイン/ログアウト
- プッシュ通知
- メール通知

### Phase 2: 管理者機能
- ダッシュボード
- 承認フロー
- 集計・レポート
- 従業員管理

### Phase 3: 高度な機能
- チャット機能（従業員⇔管理者）
- シフト交換機能
- 給与計算連携
- 複数店舗管理

### Phase 4: モバイル最適化
- オフライン対応
- カメラ機能（QRコード打刻）
- 位置情報連携

---

**作成者:** Claude (AI Assistant)
**レビュー状況:** 要レビュー
**次回更新予定:** 管理者機能実装時
